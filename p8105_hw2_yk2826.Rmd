---
title: "Homework 2"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

## Problem 1
Read and clean the data:
```{r clean_subway_data}
subway_data = 
  read_csv("./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv") %>% 
  janitor::clean_names() %>%
  select(line:entry, vending, ada) %>% 
  mutate(entry = recode(entry, "YES" = TRUE, "NO" = FALSE))
subway_data
variable.names(subway_data)
```

The dataset contains the line, station's name, the latitude and longitude of the station, the routes served by the station, whether the entrance is allowed, whether an exit/entrance is with vending, type of the entrance and whether an exit/entrance is ADA compliant.  
My data cleaning steps so far include: load the data by using "read_csv" function, clean up the column names using "janitor::clean_names", select columns that I want to keep, and convert the entry variable from character to a logical variable using "recode" function.  
The dimension (rows x columns) of the resulting dataset is `r dim(subway_data)`.  
These data are not tidy: the route number is spread across 11 columns.

Answer the following questions using these data:

```{r create_distinct_data}
distinct_data = distinct(subway_data, line, station_name, .keep_all = TRUE)
```
How many distinct stations are there?  
There are `r nrow(distinct_data)` distinct stations.

How many stations are ADA compliant?  
There are `r nrow(filter(distinct_data, ada == TRUE))` stations are ADA compliant.

What proportion of station entrances / exits without vending allow entrance?  
The proportion of station entrances / exits without vending allow entrance is 
`r nrow(filter(subway_data, entry == TRUE, vending == "NO")) / nrow(filter(subway_data, vending == "NO"))`

Reformat data so that route number and route name are distinct variables. 
```{r reformat}
distinct_tidy = gather(distinct_data, key = route_number, value = route_name, 
                       route1:route11, na.rm = TRUE)
distinct_tidy
```
How many distinct stations serve the A train? Of the stations that serve the A train, how many are ADA compliant?

`r nrow(filter(distinct_tidy, route_name == "A"))` distinct stations serve the A train.  
Of the stations that serve the A train, `r nrow(filter(distinct_tidy, route_name == "A", ada == TRUE))` are ADA compliant.

## Problem 2
Read and clean the Mr.Trash Wheel sheet:
```{r clean_mr_trash}
library(readxl)
library(cellranger)
mr_trash_data = 
  read_excel("./data/HealthyHarborWaterWheelTotals2018-7-28.xlsx", sheet = 1,
             range = cell_cols("A:N")) %>% 
  janitor::clean_names() %>%  
  filter(!is.na(dumpster), !is.na(date)) %>% 
  mutate(sports_balls = round(sports_balls), 
         sports_balls = as.integer(sports_balls))
mr_trash_data
```

Read and clean precipitation data for 2016 and 2017:
```{r clean_precipitation}
precipitation_2016 =
  read_excel("./data/HealthyHarborWaterWheelTotals2018-7-28.xlsx", sheet = 5,
             range = "A2:B14") %>% 
  janitor::clean_names() %>% 
  filter(!is.na(total)) %>% 
  mutate(year = "2016")
precipitation_2016

precipitation_2017 =
  read_excel("./data/HealthyHarborWaterWheelTotals2018-7-28.xlsx", sheet = 4,
             range = "A2:B14") %>% 
  janitor::clean_names() %>% 
  filter(!is.na(total)) %>% 
  mutate(year = "2017")
precipitation_2017
```